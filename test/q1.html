<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Physio Cube – Test – Step 1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    :root{
        --accent:#0794ae;   /* фирменный синий */
        --bg   :#ffffff;    /* фон */
    }

    /* ---------- reset ----------
       (достаточный минимум) */
    *{margin:0;padding:0;box-sizing:border-box;}
    html,body{
        height:100%;
        font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                     "Helvetica Neue", Arial, sans-serif;
        background:var(--bg);
        color:#333;
        line-height:1.6;
        -webkit-tap-highlight-color:transparent;
    }

    /* ---------- Navbar (центр, ширина = карточке) ---------- */
    .navbar{
        position:fixed;
        top:0; left:50%; transform:translateX(-50%);
        width:94%; max-width:420px;
        height:56px;
        background:var(--bg);
        border-bottom:1px solid #e0e0e0;
        display:flex; align-items:center; justify-content:space-between;
        padding:0 12px;
        z-index:1000;
    }
    .navbar .logo{height:36px;}
    .hamburger{
        width:32px;height:32px;
        background:none;border:none;
        display:flex; flex-direction:column; justify-content:space-between;
        cursor:pointer;
    }
    .hamburger .bar{
        width:100%;height:4px;
        background:#555;border-radius:2px;
    }

    /* ---------- Overlay + центр‑меню ----------
       overlay покрывает весь экран, а .menu-panel позиционируется
       по‑центру горизонтально и сразу под шапкой. */
    .overlay{
        position:fixed;
        inset:0;
        background:rgba(0,0,0,0.5);
        visibility:hidden;
        opacity:0;
        transition:opacity .25s ease, visibility .25s;
        z-index:2000;
        display:flex;
        justify-content:center;   /* центрируем меню */
        align-items:flex-start;    /* держим вверху */
    }
    .overlay.open{
        visibility:visible;
        opacity:1;
    }
    .menu-panel{
        background:var(--bg);
        width:94%; max-width:420px;
        margin-top:56px;            /* начинается под Navbar */
        border-radius:0 0 8px 8px;
        padding:.5rem 0;
        box-shadow:0 2px 6px rgba(0,0,0,0.2);
    }
    .menu-item{
        width:100%;
        text-align:left;
        padding:.75rem 1.5rem;
        font-size:1rem;
        background:none;
        border:none;
        color:var(--accent);
        cursor:pointer;
    }
    .menu-item:hover{background:#f0f8fb;}

    /* ---------- Main content ---------- */
    main{
        flex:1;
        margin-top:56px;            /* отступ под navbar */
        display:flex; justify-content:center; align-items:flex-start;
        overflow-y:auto;
        -webkit-overflow-scrolling:touch;
    }
    .card{
        width:94%; max-width:420px;
        background:var(--bg);
        border:1px solid #e0e0e0;
        border-radius:8px;
        padding:1.5rem;
        box-shadow:0 4px 12px rgba(0,0,0,0.07);
        text-align:left;
    }
    .card h2{
        font-size:1.7rem;
        color:var(--accent);
        text-align:center;
        margin-bottom:1rem;
    }
    .question{margin-bottom:1.25rem;}
    .question label{
        display:block;
        font-weight:600;
        margin-bottom:.4rem;
        color:#222;
    }
    .question textarea{
        width:100%;
        min-height:80px;
        padding:.55rem;
        font-size:1rem;
        border:1px solid #ccc;
        border-radius:4px;
        resize:vertical;
    }
    .question textarea:focus{
        outline:none;
        border-color:var(--accent);
    }
    .btn{
        display:block;
        width:100%;
        min-height:48px;
        padding:.75rem;
        font-size:1rem;
        font-weight:bold;
        color:var(--bg);
        background:var(--accent);
        border:none;
        border-radius:4px;
        cursor:pointer;
        text-align:center;
        transition:background .2s;
        margin-top:1rem;
    }
    .btn:hover{background:#056e93;}

    /* ---------- блокировка скролла тела, когда открыто меню ----------
       (добавляем класс .menu-open в <body>) */
    body.menu-open{overflow:hidden;}

    @media (min-width:480px){
        .card{padding:1.75rem;}
    }
</style>
</head>

<body>

<!--------------------------  Navbar  --------------------------->
<header class="navbar">
    <img src="../img/icon.png" alt="Physio Cube logo" class="logo">
    <button class="hamburger" aria-label="Open menu">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
    </button>
</header>

<!--------------------------  Overlay (menu)  ------------------->
<div class="overlay" id="overlay" role="dialog" aria-modal="true">
    <div class="menu-panel">
        <button class="menu-item" data-href="confidentiality.html">Confidentiality</button>
        <button class="menu-item" data-href="setting.html">Settings</button>
        <button class="menu-item" id="overlayLogoutBtn">Log out</button>
    </div>
</div>

<!--------------------------  Main content  --------------------->
<main>
    <section class="card">
        <h2>Step 1 – Questionnaire</h2>

        <form id="testForm">

            <!-- Question 1 -->
            <div class="question">
                <label for="q1">
                    When did the injury occur? <small>(date/time, was the pain immediate or delayed?)</small>
                </label>
                <textarea id="q1" name="q1" placeholder="Enter date, time and any additional details..."></textarea>
            </div>

            <!-- Question 2 -->
            <div class="question">
                <label for="q2">
                    What is the mechanism of the injury? <small>(impact, fall, strain, over‑use, etc.)</small>
                </label>
                <textarea id="q2" name="q2" placeholder="Describe how it happened..."></textarea>
            </div>

            <!-- Question 3 -->
            <div class="question">
                <label for="q3">
                    Where exactly do you feel pain? <small>(precise location, adjacent areas)</small>
                </label>
                <textarea id="q3" name="q3" placeholder="e.g. left knee, lower back..."></textarea>
            </div>

            <!-- Question 4 -->
            <div class="question">
                <label for="q4">
                    What is the nature of the pain? <small>(sharp, burning, dragging, pulsating) and its intensity on a scale of 1‑10</small>
                </label>
                <textarea id="q4" name="q4" placeholder="Describe the quality and rate the pain…"></textarea>
            </div>

            <!-- Question 5 -->
            <div class="question">
                <label for="q5">
                    What aggravates or relieves the pain? <small>(certain movements, posture, rest, cold/heat)</small>
                </label>
                <textarea id="q5" name="q5" placeholder="e.g. walking worsens, ice helps…"></textarea>
            </div>

            <!-- Question 6 -->
            <div class="question">
                <label for="q6">
                    Is there any limitation in movement? <small>(range, pain in certain positions, swelling, numbness)</small>
                </label>
                <textarea id="q6" name="q6" placeholder="Describe any restrictions…"></textarea>
            </div>

            <!-- Question 7 -->
            <div class="question">
                <label for="q7">
                    Which actions or activities cannot you perform? <small>(lifting, walking, sitting, sport, etc.)</small>
                </label>
                <textarea id="q7" name="q7" placeholder="List the activities you avoid…"></textarea>
            </div>

            <!-- Question 8 -->
            <div class="question">
                <label for="q8">
                    Have you received any treatment? <small>(massage, physiotherapy, medication, surgery) – outcomes and timelines</small>
                </label>
                <textarea id="q8" name="q8" placeholder="Mention any treatment you tried…"></textarea>
            </div>

            <!-- Question 9 -->
            <div class="question">
                <label for="q9">
                    Do you have any chronic conditions or previous injuries in the same area?
                </label>
                <textarea id="q9" name="q9" placeholder="Explain any relevant history…"></textarea>
            </div>

            <!-- Question 10 -->
            <div class="question">
                <label for="q10">
                    Are you willing to perform the series of movements/positions required for a 3‑D scan? <small>(any limits in flexibility, balance, pose‑holding time)</small>
                </label>
                <textarea id="q10" name="q10" placeholder="Your answer…"></textarea>
            </div>

            <button type="button" class="btn" id="nextBtn">Next →</button>
        </form>
    </section>
</main>

<script>
/* --------------------------------------------------------------
   1.  Burger‑menu handling (centered, accessible, scroll lock)
   -------------------------------------------------------------- */
const hamburger = document.querySelector('.hamburger');
const overlay   = document.getElementById('overlay');
let firstMenuItem = null;          // ссылка на первую кнопку меню (для авто‑фокуса)

function openMenu(){
    overlay.classList.add('open');
    document.body.classList.add('menu-open');  // блокируем скролл страницы
    // авто‑фокус на первом пункте меню
    firstMenuItem = overlay.querySelector('.menu-item');
    if (firstMenuItem) firstMenuItem.focus();
}
function closeMenu(){
    overlay.classList.remove('open');
    document.body.classList.remove('menu-open');
    hamburger.focus();           // возвращаем фокус к иконке
}
hamburger.addEventListener('click', openMenu);

// клик по затемнённой области закрывает меню
overlay.addEventListener('click', e => {
    if (e.target === overlay) closeMenu();
});

// навигация пунктов меню
document.querySelectorAll('.menu-item[data-href]').forEach(btn => {
    btn.addEventListener('click', e => {
        e.stopPropagation();                // не даём событию “click” дойти до overlay
        const target = btn.getAttribute('data-href');
        closeMenu();
        // небольшая задержка, чтобы анимация закрытия успела отработать
        setTimeout(() => { window.location.href = target; }, 150);
    });
});

// logout‑кнопка внутри overlay
document.getElementById('overlayLogoutBtn').addEventListener('click', e => {
    e.stopPropagation();
    closeMenu();
    setTimeout(() => {
        localStorage.removeItem('physioCube_currentUser');
        localStorage.removeItem('physioCube_email');
        window.location.href = '../user/login.html';
    }, 150);
});

// Escape закрывает меню
document.addEventListener('keydown', e => {
    if (e.key === 'Escape' && overlay.classList.contains('open')) {
        closeMenu();
    }
});

/* --------------------------------------------------------------
   2.  Сохранить ответы и перейти к следующему шагу (q2.html)
   -------------------------------------------------------------- */
const form    = document.getElementById('testForm');
const nextBtn = document.getElementById('nextBtn');

nextBtn.addEventListener('click', () => {
    const answers = {
        q1 : document.getElementById('q1').value.trim(),
        q2 : document.getElementById('q2').value.trim(),
        q3 : document.getElementById('q3').value.trim(),
        q4 : document.getElementById('q4').value.trim(),
        q5 : document.getElementById('q5').value.trim(),
        q6 : document.getElementById('q6').value.trim(),
        q7 : document.getElementById('q7').value.trim(),
        q8 : document.getElementById('q8').value.trim(),
        q9 : document.getElementById('q9').value.trim(),
        q10: document.getElementById('q10').value.trim()
    };
    // сохраняем в localStorage (будет читаться в q2.html)
    localStorage.setItem('physioCube_test_q1', JSON.stringify(answers));
    // переходим к следующему шагу
    window.location.href = 'q2.html';
});
</script>
</body>
</html>
